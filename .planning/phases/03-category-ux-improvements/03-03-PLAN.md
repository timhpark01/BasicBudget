---
phase: 03-category-ux-improvements
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - components/shared/CategoryIconPicker.tsx
autonomous: true

must_haves:
  truths:
    - "User can search/filter icons by typing keywords"
    - "Icon grid shows only matching icons when search is active"
    - "Search clears easily via clear button"
    - "Empty search results show helpful message"
    - "All icon boxes meet 44px minimum tap target"
  artifacts:
    - path: "components/shared/CategoryIconPicker.tsx"
      provides: "Icon picker with search and accessibility"
      contains: "TextInput"
      min_lines: 100
  key_links:
    - from: "components/shared/CategoryIconPicker.tsx"
      to: "CATEGORY_ICONS"
      via: "Array filter based on search query"
      pattern: "CATEGORY_ICONS\\.filter"
---

<objective>
Add search/filter capability and accessibility improvements to icon picker for better browsability

Purpose: Make icon selection faster and more accessible for 44 available icons
Output: Icon picker with search input, filtered results, accessibility labels, and empty state handling
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-category-ux-improvements/03-RESEARCH.md
@.planning/phases/03-category-ux-improvements/03-01-SUMMARY.md

# Current implementation
@components/shared/CategoryIconPicker.tsx
@constants/colors.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add search/filter functionality to icon picker</name>
  <files>components/shared/CategoryIconPicker.tsx</files>
  <action>
Add search input and filtering logic to CategoryIconPicker:

1. Import useState at top:
```typescript
import React, { useState } from 'react';
```

2. Add search state inside component (after props destructuring):
```typescript
const [searchQuery, setSearchQuery] = useState('');
```

3. Add filtered icons logic:
```typescript
const filteredIcons = CATEGORY_ICONS.filter(icon =>
  searchQuery ? icon.toLowerCase().includes(searchQuery.toLowerCase()) : true
);
```

4. Replace direct CATEGORY_ICONS.map with filteredIcons.map (line ~21):
```typescript
// OLD:
{CATEGORY_ICONS.map((iconName) => (

// NEW:
{filteredIcons.map((iconName) => (
```

5. Add search input BEFORE iconsGrid (after label):
```typescript
<Text style={styles.label}>Icon</Text>

<TextInput
  style={styles.searchInput}
  placeholder="Search icons (e.g., food, travel)..."
  value={searchQuery}
  onChangeText={setSearchQuery}
  clearButtonMode="while-editing"
  autoCapitalize="none"
  autoCorrect={false}
  accessibilityLabel="Search category icons"
  placeholderTextColor="#999"
/>

<View style={styles.iconsGrid}>
```

6. Add empty state after closing iconsGrid </View>:
```typescript
</View>

{filteredIcons.length === 0 && (
  <Text style={styles.noResults}>
    No icons found for "{searchQuery}". Try a different search.
  </Text>
)}
```

7. Add new styles to StyleSheet:
```typescript
searchInput: {
  backgroundColor: '#fff',
  borderWidth: 1,
  borderColor: '#e0e0e0',
  borderRadius: 8,
  paddingHorizontal: 16,
  paddingVertical: 12,
  fontSize: 16,
  color: '#333',
  marginBottom: 16,
},
noResults: {
  textAlign: 'center',
  color: '#999',
  marginTop: 24,
  fontSize: 14,
  fontStyle: 'italic',
},
```

Research finding: Simple substring matching (string.includes()) is sufficient for 44 icons - don't over-engineer with fuzzy search libraries. Budget apps specifically benefit from search/filter functionality for icon selection to enable quick access.
  </action>
  <verify>
1. Read CategoryIconPicker.tsx and confirm:
   - useState import exists
   - searchQuery state declared
   - filteredIcons logic exists
   - TextInput rendered before iconsGrid
   - Empty state handling exists
   - New styles added
2. Run app and test icon picker:
```bash
npm start
```
3. In app, open category modal and test:
   - Type "food" → should show restaurant, pizza, cafe, fast-food icons only
   - Type "car" → should show car, bicycle icons
   - Type "xyz" → should show "No icons found" message
   - Clear search → should show all 44 icons again
   - iOS: clearButtonMode should show X button when typing
  </verify>
  <done>
Icon picker has search input that filters icons in real-time, empty search shows helpful message, search clears via iOS clear button or manual deletion, filtered results update immediately as user types
  </done>
</task>

<task type="auto">
  <name>Task 2: Add accessibility improvements to icon picker</name>
  <files>components/shared/CategoryIconPicker.tsx</files>
  <action>
Enhance icon picker with WCAG-compliant accessibility props:

1. Update TouchableOpacity for each icon box (inside filteredIcons.map):

**CURRENT (line ~22):**
```typescript
<TouchableOpacity
  key={iconName}
  style={[...]}
  onPress={() => onSelectIcon(iconName)}
  activeOpacity={0.7}
>
```

**REPLACE with:**
```typescript
<TouchableOpacity
  key={iconName}
  style={[...]}
  onPress={() => onSelectIcon(iconName)}
  activeOpacity={0.7}
  accessibilityRole="button"
  accessibilityLabel={`${iconName} icon`}
  accessibilityState={{ selected: selectedIcon === iconName }}
  accessibilityHint="Double tap to select this icon for your category"
>
```

2. Verify tap target sizes in styles (existing styles should already be correct):
- iconBox width: 56px ✓ (exceeds 44px WCAG minimum)
- iconBox height: 56px ✓
- gap: 12px ✓ (adequate spacing between tap targets)

No changes needed to dimensions - current implementation already meets WCAG 2.1 AAA requirements (44x44px minimum tap targets).

Research finding: Apple recommends 44px minimum tap targets, Google Material Design uses 48px, WCAG 2.1 AAA requires 44x44px. Current implementation (56px boxes with 12px gap) exceeds these requirements. Accessibility props enable screen readers to announce icon selection state.
  </action>
  <verify>
1. Read CategoryIconPicker.tsx and confirm accessibility props added to TouchableOpacity
2. Run app with VoiceOver/TalkBack if available (optional - manual testing):
   - VoiceOver should announce "restaurant icon button, selected" for selected icon
   - VoiceOver should announce "wallet icon button" for unselected icons
   - Double-tap should select the icon
3. Visual check:
   - Icon boxes remain 56x56px
   - 12px gap between icons maintained
   - No layout changes from accessibility additions
  </verify>
  <done>
Icon picker TouchableOpacity elements have proper accessibility roles, labels, states, and hints for screen reader users; tap targets exceed WCAG minimum requirements (56px boxes); accessibility improvements are invisible to sighted users but enable full screen reader functionality
  </done>
</task>

</tasks>

<verification>
Icon picker improvements complete when:
- Search input exists above icon grid with proper placeholder
- Icons filter in real-time based on search query (case-insensitive substring matching)
- Empty search results show helpful "No icons found" message
- iOS clearButtonMode provides X button for easy search clearing
- All icon TouchableOpacity elements have accessibility props (role, label, state, hint)
- Tap targets meet WCAG 2.1 AAA requirements (56px exceeds 44px minimum)
</verification>

<success_criteria>
- UX-02 fully addressed: Icon selection interface improved with search and better browsability
- UX-01 partially addressed: Icon picker is more intuitive with search capability
- Accessibility improvements enable screen reader users to navigate icon picker effectively
- Search pattern established for reuse in other pickers (color picker could use similar pattern)
</success_criteria>

<output>
After completion, create `.planning/phases/03-category-ux-improvements/03-03-SUMMARY.md`
</output>
